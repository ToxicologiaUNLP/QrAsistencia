<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laboratorio Central</title>
    <style>
        body {font-family: Arial, sans-serif; margin:0; padding:0; background-color: #61adc1;}
        header {text-align:center; padding:20px; background:white;}
        header img {max-width:200px; margin-bottom:10px;}
        header h1 {margin:0; font-size:2em; color:#003d4d;}
        header h2 {margin:5px 0 0; font-size:1.2em; color:#005f73;}
        .container {padding:20px; max-width:1200px; margin:auto;}
        #search {padding:10px; width:100%; font-size:16px; border-radius:8px; border:1px solid #ccc; margin-bottom:10px;}
        #results {list-style:none; padding:0; margin:0;}
        #results li {padding:10px; background:white; margin-bottom:5px; border-radius:6px; cursor:pointer;}
        #results li:hover {background:#e0f0f5;}
        #details {display:none; margin-top:20px; background:white; padding:15px; border-radius:8px;}
        table {width:100%; border-collapse: collapse;}
        td {border-bottom:1px solid #eee; padding:8px; vertical-align:top;}
        td:first-child {font-weight:bold; color:#003d4d; width:25%;}
    </style>
</head>
<body>
    <header>
        <img src="logolab.png" alt="Logo">
        <h1>Laboratorio Central</h1>
        <h2>Valores de referencia y condiciones de toma de muestra</h2>
    </header>
    <div class="container">
        <input type="text" id="search" placeholder="Buscar estudio...">
        <ul id="results"></ul>
        <div id="details">
            <h3>Detalles del estudio</h3>
            <table id="detailsTable"></table>
        </div>
    </div>
    <script>
        const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT_1_DpeDPmqZOjSmtIGeb8Ri-yuGtWz7sWwwFMdyWssacb5RTdJkpu_7OBPi_yPw/pub?output=csv";
        let studies = [];

        fetch(csvUrl)
        .then(r=>r.text())
        .then(data=>{
            const rows = data.split("\n").map(r=>r.split(","));
            const headers = rows.shift();
            studies = rows.map(r=>{
                let obj = {};
                headers.forEach((h,i)=>{ obj[h.trim()] = r[i]? r[i].trim() : ""; });
                return obj;
            });
        });

        const searchInput = document.getElementById("search");
        const resultsList = document.getElementById("results");
        const detailsDiv = document.getElementById("details");
        const detailsTable = document.getElementById("detailsTable");

        searchInput.addEventListener("input", ()=>{
            const query = searchInput.value.toLowerCase();
            resultsList.innerHTML = "";
            const filtered = studies.filter(s=>s.ESTUDIOS.toLowerCase().includes(query));
            filtered.forEach(study=>{
                const li = document.createElement("li");
                li.textContent = study.ESTUDIOS;
                li.onclick = ()=>showDetails(study);
                resultsList.appendChild(li);
            });
        });

        function showDetails(study){
            detailsDiv.style.display = "block";
            detailsTable.innerHTML = "";
            for(const [key,value] of Object.entries(study)){
                const row = detailsTable.insertRow();
                const cell1 = row.insertCell(0);
                const cell2 = row.insertCell(1);
                cell1.textContent = key;
                cell2.textContent = value;
            }
        }
    </script>
</body>
</html>
